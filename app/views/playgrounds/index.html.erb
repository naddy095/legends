<%= stylesheet_link_tag "gmaps4rails" %>

<style>
/*#floating-panel {
  position: absolute;
  top: 10px;
  left: 45%;
  z-index: 5;
  background-color: #fff;
  padding: 5px;
  border: 1px solid #999;
  text-align: center;
  font-family: 'Roboto','sans-serif';
  line-height: 30px;
  padding-left: 10px;
}*/

</style>

<%= gmaps(:markers => {
            :data => @json,        
          }, 
          :map_options => {
            :do_clustering => false, 
            :disableDoubleClickZoom => true,
            :detect_location => true,       
            :center_on_user  => true,        
            :zoom => 6,
            :auto_adjust => false
          }
) %>

<!--div id="floating-panel" onclick="drop()">Click to mark home</div-->


<%= content_for :scripts do %>
    <script>
        // Document ready stuff
        $(document).ready(function() {
            // Bizarre ajax errors
            $(document).bind("ajaxError", function() {
                alert_user('There was an error processing your request. Please try again later', 'alert-error');
            });
        });

        // Instance geocoder
        var geocoder = new google.maps.Geocoder();

        // New marker beacon
        var playgroundsNewMarker = null;

        // Google maps map-related events
        Gmaps.map.callback = function() {

            // Double click event to show new marker form
            google.maps.event.addListener(Gmaps.map.serviceObject, 'click', function(event) {            
    
                // Remove previous marker when adding a new one
                clearMarker(playgroundsNewMarker);
    
                // Geocode point. Callback on success will show the creation form
                geocodePoint(event.latLng, function(data) {
                   playgroundsNew(data);
                });                
            });
        }; 
    </script>
<% end %>

<%# content_for :contextual do %>
    <%#=render :partial => 'home_side' %>
<%# end %>




